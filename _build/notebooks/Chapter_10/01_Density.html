---
redirect_from:
  - "/notebooks/chapter-10/01-density"
interact_link: content/notebooks/Chapter_10/01_Density.ipynb
kernel_name: python3
has_widgets: false
title: |-
  Density
prev_page:
  url: /notebooks/Chapter_10/00_Probability_Density.html
  title: |-
    Probability Density
next_page:
  url: /notebooks/Chapter_10/02_Expectation_and_Variance.html
  title: |-
    Expectation and Variance
comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered">

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Density">Density<a class="anchor-link" href="#Density"> </a></h2><p>Let $f$ be a non-negative function on the real number line and suppose</p>
<p>$$
\int_{-\infty}^\infty f(x)dx ~ = 1
$$</p>
<p>Then $f$ is a <em>probability density function</em> or just <em>density</em> for short.</p>
<p>This integral is the total area under the curve $f$. The condition that it has to be 1 allows us to think of the areas under the curve as probabilities.</p>
<p>As an example, the function $f$ defined by</p>
<p>$$
f(x) = 
\begin{cases}
0 ~~~~~~~~~~~~~~~~~~ \text{if } x \le 0 \\
6x(1-x) ~~~~~ \text{if } 0 &lt; x &lt; 1 \\
0 ~~~~~~~~~~~~~~~~~~ \text{if } x \ge 1 \\
\end{cases}
$$</p>
<p>is a density. It is easy to check by calculus that it integrates to 1.</p>
<p>Here is a graph of $f$. The density puts all the probability on the unit interval.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/notebooks/Chapter_10/01_Density_2_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Density-is-Not-the-Same-as-Probability">Density is Not the Same as Probability<a class="anchor-link" href="#Density-is-Not-the-Same-as-Probability"> </a></h3><p>In the example above, $f(0.5) = 6/4 = 1.5 &gt; 1$. Indeed, there are many values of $x$ for which $f(x) &gt; 1$. So the values of $f$ are clearly not probabilities.</p>
<p>Then what are they? We'll get to that later in this section. First we will see that we can work with densities just as we did with the normal curve.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Areas-are-Probabilities">Areas are Probabilities<a class="anchor-link" href="#Areas-are-Probabilities"> </a></h3><p>A random variable $X$ is said to <em>have density $f$</em> if for every pair $a &lt; b$,</p>
<p>$$
P(a &lt; X \le b) ~ = ~ \int_a^b f(x)dx
$$</p>
<p>This integral is the area between $a$ and $b$ under the density curve. The graph below shows the area corresponding to $P(0.6 &lt; X \le 0.8)$ for $X$ with the density in our example.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/notebooks/Chapter_10/01_Density_5_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The area is
$$
P(0.6 &lt; X \le 0.8) ~ = ~ \int_{0.6}^{0.8} 6x(1-x)dx
$$</p>
<p>We'll do the integral below.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cumulative-Distribution-Function-(CDF)">Cumulative Distribution Function (CDF)<a class="anchor-link" href="#Cumulative-Distribution-Function-(CDF)"> </a></h3><p>As before, the cdf of $X$ is the function $F$ defined by
$F(x) = P(X \le x)$, but now the probability is computed as an integral instead of a sum.</p>
<p>$$
F(x) ~ = ~ P(X \le x) ~ = ~ \int_{-\infty}^x f(s)ds
$$</p>
<p>In our example, the density is positive only between 0 and 1, so $F(x) = 0$ for $x \le 0$ and $F(x) = 1$ for $x \ge 1$.
For $x \in (0, 1)$,</p>
<p>$$
\begin{align*}
F(x) ~ &amp;= ~ \int_0^x 6s(1-s)ds \\
&amp;= ~ 6\int_0^x sds ~ - ~  6\int_0^x s^2ds \\
&amp;= ~ 3x^2 - 2x^3
\end{align*}
$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/notebooks/Chapter_10/01_Density_8_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In terms of the graph of the density, $F(x)$ is all the area to the left of $x$ under the density curve. The graph below shows the area corresponding to $F(0.8)$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/notebooks/Chapter_10/01_Density_10_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$$
P(X \le 0.8) ~ = ~  F(0.8) ~ = ~ 3\cdot0.8^3 - 2\cdot0.8^2 ~ = ~ 0.896
$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As before, the cdf can be used to find probabilities of intervals. For every pair $a &lt; b$,</p>
<p>$$
P(a &lt; X \le b) ~ = ~ F(b) - F(a) 
$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/notebooks/Chapter_10/01_Density_13_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>\begin{align*}
F(0.6) ~ &amp;= ~ 3\cdot0.6^3 - 2\cdot0.6^2 ~ = ~ 0.648 \\
F(0.8) - F(0.6) ~ &amp;= ~ 0.896 - 0.648 ~ = ~ 0.248
\end{align*}</p>
<p>You can get the same answer by integrating the density between 0.6 and 0.8.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By the Fundamental Theorem of Calculus, the density and cdf can be derived from each other:</p>
<p>$$
F(x) = \int_{-\infty}^x f(s)ds ~~~~~~~~~~~~~~~~~~ f(x) = \frac{d}{dx}F(x)
$$</p>
<p>You can use whichever of the two functions is more convenient in a particular application.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="No-Probability-at-Any-Single-Point">No Probability at Any Single Point<a class="anchor-link" href="#No-Probability-at-Any-Single-Point"> </a></h3><p>A wonderful aspect of a random variable that has a density, like the random variable $X$ above, is that there is no chance of hitting a possible value exactly. That is, for each $x$, we have $P(X = x) = 0$. It's because probabilities are areas under the density curve, and the area of a line is 0.</p>
<p>This is the analog of the fact that each point on the number line has length 0, but intervals still have positive length.</p>
<p>This makes calculations easier, because including or excluding single points in events won't change the probability. For example,</p>
<p>$$
\begin{align*}
P(0.6 &lt; X \le 0.8) ~ &amp;= ~ P(0.6 \le X \le 0.8) \\
&amp;= ~ P(0.6 \le X &lt; 0.8) \\
&amp;= ~ P(0.6 &lt; X &lt; 0.8)
\end{align*}
$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Meaning-of-Density">The Meaning of Density<a class="anchor-link" href="#The-Meaning-of-Density"> </a></h3><p>While $P(X = x) = 0$ for each $x$, the chance that $X$ is in a tiny interval near $x$ is positive if $f(x) &gt; 0$.</p>
<p>The gold strip in the figure below is $P(X \in (x, x+\Delta x))$ for a very small width $\Delta x$. The shape of the strip is essentially a rectangle with height $f(x)$ and with $\Delta x$. So when $\Delta x$ is tiny,</p>
<p>$$
P(X \in (x, x+\Delta x)) ~ \approx ~ f(x)\Delta x
$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/notebooks/Chapter_10/01_Density_18_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thus</p>
<p>$$
f(x) ~ \approx ~ \frac{P(X \in (x, x+\Delta x))}{\Delta x}
$$</p>
<p>In other words, $f$ measures the chance that $X$ is in a tiny interval near $x$, <em>relative to the width of the interval</em>.</p>
<p>Let the width $\Delta x$ get tinier and tinier. In the limit as $\Delta x$ goes to 0, $f$ measures <em>probability per unit length</em>. That is why $f$ is called a <em>probability density</em> function.</p>
<p>Recall from Data 8 that in a discrete histogram, areas represent percents, and the height of the bar over a bin is given by</p>
<p>$$
\text{height of bar} ~ = ~ \frac{\text{percent in bin}}{\text{width of bin}}
$$</p>
<p>Probability density is the idealization of this as the amount of data goes becomes infinitely large and the width of each bin becomes infinitesimally small.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Analogous-Calculations">Analogous Calculations<a class="anchor-link" href="#Analogous-Calculations"> </a></h3><p>Many calculations involving densities are direct analogs of calculations for discrete random variables.</p>
<p>For example, if $X$ has density $f$, then for constants $a &lt; b$ we have</p>
<p>$$
P(a &lt; X \le b) ~ = ~ \int_a^b f(x)dx
$$</p>
<p>If instead $X$ is an integer-valued random variable, then for integers $a &lt; b$ we have</p>
<p>$$
P(a &lt; X \le b) ~ = ~ \sum_{x=a}^b P(X=x)
$$</p>
<p>In the next section we will develop the analogs for calculating expectation and variance.</p>

</div>
</div>
</div>
</div>

 

